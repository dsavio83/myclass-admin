<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload Debug Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .status-box {
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .status-success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .status-error { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .status-warning { background-color: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .status-info { background-color: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #007bff;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .test-section {
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .test-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            max-height: 200px;
            overflow-y: auto;
        }
        
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        
        button:hover { background-color: #0056b3; }
        button:disabled { background-color: #6c757d; cursor: not-allowed; }
        
        input[type="file"], input[type="text"], input[type="url"] {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            width: 100%;
        }
        
        .log-entry {
            font-size: 12px;
            color: #6c757d;
            margin: 2px 0;
            font-family: monospace;
        }
        
        .config-display {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üêõ Upload Debug Test Suite</h1>
    <p>Comprehensive test suite to debug and validate upload timeout fixes</p>
    
    <div class="card">
        <h3>üìã Test Configuration</h3>
        <div class="test-section">
            <label>Lesson ID: </label>
            <input type="text" id="lessonId" value="676a12345678901234567890" style="width: 300px;">
            <br><br>
            <label>Resource Type: </label>
            <select id="resourceType">
                <option value="book">Book</option>
                <option value="video">Video</option>
                <option value="audio">Audio</option>
                <option value="worksheet">Worksheet</option>
                <option value="slide">Slide</option>
                <option value="notes">Notes</option>
            </select>
            <br><br>
            <label>Title: </label>
            <input type="text" id="title" value="Debug Test - " style="width: 300px;">
            <br><br>
            <label>Cloud Name: </label>
            <input type="text" id="cloudName" value="learning-platform-25" style="width: 300px;">
            <br><br>
            <label>Upload Preset: </label>
            <input type="text" id="uploadPreset" value="your-upload-preset" style="width: 300px;">
        </div>
    </div>

    <div class="card">
        <h3>üîß Environment Configuration Test</h3>
        <div class="test-section">
            <button onclick="testEnvironmentConfig()">üîç Test Environment Config</button>
            <button onclick="testCloudinaryConfig()">‚òÅÔ∏è Test Cloudinary Config</button>
            <button onclick="testAPIEndpoints()">üåê Test API Endpoints</button>
            
            <div class="config-display" id="configDisplay">
                Environment configuration will be displayed here...
            </div>
        </div>
    </div>

    <div class="card">
        <h3>üìÅ File Upload Tests</h3>
        <div class="test-section">
            <input type="file" id="testFile" accept=".pdf,.jpg,.png,.mp4,.mp3">
            <button onclick="testFileValidation()">‚úÖ Test File Validation</button>
            <button onclick="testDuplicateCheck()">üîç Test Duplicate Check</button>
            <button onclick="testCloudinaryUpload()">‚òÅÔ∏è Test Cloudinary Upload Only</button>
            <button onclick="testDatabaseSave()">üíæ Test Database Save Only</button>
            <button onclick="testFullUpload()">üöÄ Test Full Upload (Two-Step)</button>
            <button onclick="testErrorHandling()">‚ö†Ô∏è Test Error Handling</button>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div id="uploadStatus" class="status-info">Ready to test</div>
            
            <div class="test-result" id="testResult"></div>
        </div>
    </div>

    <div class="card">
        <h3>üìä Test Logs</h3>
        <div id="testLogs" style="max-height: 300px; overflow-y: auto; background: #f8f9fa; padding: 10px; border-radius: 4px;"></div>
    </div>

    <div class="card">
        <h3>üîß Manual Debug Tests</h3>
        <div class="test-section">
            <h4>1. Configuration Tests</h4>
            <button onclick="testMissingConfig()">‚ùå Test Missing Config</button>
            <button onclick="testInvalidConfig()">‚ö†Ô∏è Test Invalid Config</button>
            <button onclick="testValidConfig()">‚úÖ Test Valid Config</button>
            
            <h4>2. Timeout Tests</h4>
            <button onclick="testTimeoutHandling()">‚è±Ô∏è Test Timeout Handling</button>
            <button onclick="testLargeFile()">üìÅ Test Large File Handling</button>
            <button onclick="testNetworkFailure()">üåê Test Network Failure</button>
            
            <h4>3. Error Recovery Tests</h4>
            <button onclick="testCleanupOnFailure()">üßπ Test Cleanup on Failure</button>
            <button onclick="testRetryLogic()">üîÑ Test Retry Logic</button>
            <button onclick="testDuplicatePrevention()">üîí Test Duplicate Prevention</button>
        </div>
    </div>

    <script>
        // Test utilities
        const log = (message, type = 'info') => {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.innerHTML = `[${timestamp}] <span style="color: ${type === 'error' ? '#dc3545' : type === 'success' ? '#28a745' : '#007bff'}">${type.toUpperCase()}</span>: ${message}`;
            document.getElementById('testLogs').appendChild(logEntry);
            document.getElementById('testLogs').scrollTop = document.getElementById('testLogs').scrollHeight;
        };

        const updateStatus = (message, type = 'info') => {
            const statusEl = document.getElementById('uploadStatus');
            statusEl.textContent = message;
            statusEl.className = `status-${type}`;
        };

        const updateProgress = (percentage) => {
            document.getElementById('progressFill').style.width = `${percentage}%`;
        };

        const setResult = (result) => {
            document.getElementById('testResult').textContent = JSON.stringify(result, null, 2);
        };

        const getConfig = () => ({
            lessonId: document.getElementById('lessonId').value,
            resourceType: document.getElementById('resourceType').value,
            title: document.getElementById('title').value + new Date().toISOString().slice(11, 19),
            cloudName: document.getElementById('cloudName').value,
            uploadPreset: document.getElementById('uploadPreset').value
        });

        // Environment Configuration Tests
        function testEnvironmentConfig() {
            log('Testing environment configuration...');
            updateStatus('Checking environment configuration...', 'info');

            const config = {
                cloudName: getConfig().cloudName,
                uploadPreset: getConfig().uploadPreset,
                lessonId: getConfig().lessonId
            };

            const configDisplay = document.getElementById('configDisplay');
            configDisplay.innerHTML = `
                <strong>Environment Configuration:</strong><br>
                Cloud Name: ${config.cloudName || 'NOT SET'}<br>
                Upload Preset: ${config.uploadPreset || 'NOT SET'}<br>
                Lesson ID: ${config.lessonId || 'NOT SET'}<br>
                <br>
                <strong>Validation:</strong><br>
                Cloud Name Valid: ${config.cloudName ? '‚úÖ' : '‚ùå'}<br>
                Upload Preset Valid: ${config.uploadPreset ? '‚úÖ' : '‚ùå'}<br>
                Lesson ID Valid: ${config.lessonId ? '‚úÖ' : '‚ùå'}
            `;

            if (config.cloudName && config.uploadPreset && config.lessonId) {
                updateStatus('‚úÖ Environment configuration is valid', 'success');
                log('Environment configuration is valid', 'success');
            } else {
                updateStatus('‚ùå Environment configuration is missing required values', 'error');
                log('Environment configuration is missing required values', 'error');
            }
        }

        function testCloudinaryConfig() {
            log('Testing Cloudinary configuration...');
            updateStatus('Testing Cloudinary configuration...', 'info');

            // Test Cloudinary API availability
            fetch(`https://api.cloudinary.com/v1_1/${getConfig().cloudName}/ping`)
                .then(response => {
                    if (response.ok) {
                        updateStatus('‚úÖ Cloudinary API is accessible', 'success');
                        log('Cloudinary API is accessible', 'success');
                    } else {
                        updateStatus('‚ùå Cloudinary API returned error', 'error');
                        log(`Cloudinary API error: ${response.status}`, 'error');
                    }
                })
                .catch(error => {
                    updateStatus('‚ùå Cloudinary API is not accessible', 'error');
                    log(`Cloudinary API error: ${error.message}`, 'error');
                });
        }

        function testAPIEndpoints() {
            log('Testing API endpoints...');
            updateStatus('Testing API endpoints...', 'info');

            // Test duplicate check endpoint
            const config = getConfig();
            fetch(`/api/content/check-duplicate?lessonId=${config.lessonId}&title=${encodeURIComponent(config.title)}&type=${config.resourceType}`)
                .then(response => {
                    if (response.ok) {
                        updateStatus('‚úÖ Duplicate check endpoint is working', 'success');
                        log('Duplicate check endpoint is working', 'success');
                    } else {
                        updateStatus('‚ùå Duplicate check endpoint returned error', 'error');
                        log(`Duplicate check error: ${response.status}`, 'error');
                    }
                })
                .catch(error => {
                    updateStatus('‚ùå Duplicate check endpoint is not accessible', 'error');
                    log(`Duplicate check error: ${error.message}`, 'error');
                });
        }

        // File Validation Tests
        async function testFileValidation() {
            log('Starting file validation test...');
            updateStatus('Testing file validation...', 'info');
            
            const fileInput = document.getElementById('testFile');
            const file = fileInput.files[0];
            
            if (!file) {
                updateStatus('Please select a file first', 'error');
                log('No file selected', 'error');
                return;
            }

            // Simulate file validation
            const maxSize = 15 * 1024 * 1024; // 15MB
            const allowedTypes = [
                'application/pdf', 'image/jpeg', 'image/jpg', 'image/png', 
                'image/gif', 'video/mp4', 'audio/mpeg', 'audio/wav'
            ];

            let isValid = true;
            let error = '';

            if (file.size > maxSize) {
                isValid = false;
                error = `File too large: ${(file.size / (1024 * 1024)).toFixed(2)}MB (max 15MB)`;
            } else if (!allowedTypes.includes(file.type)) {
                isValid = false;
                error = `Invalid file type: ${file.type}`;
            }

            if (isValid) {
                updateStatus('‚úÖ File validation passed', 'success');
                log(`File validation passed: ${file.name} (${(file.size / 1024).toFixed(2)}KB)`, 'success');
            } else {
                updateStatus(`‚ùå File validation failed: ${error}`, 'error');
                log(`File validation failed: ${error}`, 'error');
            }
        }

        // Duplicate Check Test
        async function testDuplicateCheck() {
            log('Starting duplicate check test...');
            updateStatus('Checking for duplicates...', 'info');

            const config = getConfig();
            
            try {
                const response = await fetch(`/api/content/check-duplicate?lessonId=${config.lessonId}&title=${encodeURIComponent(config.title)}&type=${config.resourceType}`);
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.isDuplicate) {
                        updateStatus('‚ö†Ô∏è Duplicate content detected', 'warning');
                        log('Duplicate content found', 'warning');
                    } else {
                        updateStatus('‚úÖ No duplicates found', 'success');
                        log('No duplicate content', 'success');
                    }
                    setResult(result);
                } else {
                    throw new Error('Duplicate check failed');
                }
            } catch (error) {
                updateStatus('‚ö†Ô∏è Could not check duplicates', 'warning');
                log(`Duplicate check error: ${error.message}`, 'error');
            }
        }

        // Cloudinary Upload Test
        async function testCloudinaryUpload() {
            log('Starting Cloudinary upload test...');
            updateStatus('Uploading to Cloudinary...', 'info');

            const fileInput = document.getElementById('testFile');
            const file = fileInput.files[0];
            const config = getConfig();

            if (!file) {
                updateStatus('Please select a file first', 'error');
                return;
            }

            try {
                // Simulate Cloudinary upload with progress tracking
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', config.uploadPreset);

                // Mock progress tracking
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 10;
                    updateProgress(progress);
                    if (progress >= 100) clearInterval(progressInterval);
                }, 100);

                // Simulate API call
                const response = await fetch(`https://api.cloudinary.com/v1_1/${config.cloudName}/auto/upload`, {
                    method: 'POST',
                    body: formData
                });

                clearInterval(progressInterval);
                updateProgress(100);

                if (response.ok) {
                    const result = await response.json();
                    updateStatus('‚úÖ Cloudinary upload successful', 'success');
                    log(`Cloudinary upload successful: ${result.public_id}`, 'success');
                    setResult({ cloudinaryResult: result });
                } else {
                    throw new Error('Cloudinary upload failed');
                }
            } catch (error) {
                updateStatus('‚ùå Cloudinary upload failed', 'error');
                log(`Cloudinary upload error: ${error.message}`, 'error');
            }
        }

        // Database Save Test
        async function testDatabaseSave() {
            log('Starting database save test...');
            updateStatus('Saving to database...', 'info');

            const config = getConfig();

            try {
                const response = await fetch('/api/content/cloudinary-save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        lessonId: config.lessonId,
                        title: config.title,
                        type: config.resourceType,
                        fileUrl: 'https://example.com/test.pdf',
                        publicId: 'test_public_id',
                        size: 1024,
                        mimeType: 'application/pdf',
                        resourceType: 'image'
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    updateStatus('‚úÖ Database save successful', 'success');
                    log('Database save successful', 'success');
                    setResult({ databaseResult: result });
                } else {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Database save failed');
                }
            } catch (error) {
                updateStatus('‚ùå Database save failed', 'error');
                log(`Database save error: ${error.message}`, 'error');
            }
        }

        // Full Upload Test (Two-Step Process)
        async function testFullUpload() {
            log('Starting full upload test (Two-Step Process)...');
            updateStatus('Starting full upload process...', 'info');

            const fileInput = document.getElementById('testFile');
            const file = fileInput.files[0];
            const config = getConfig();

            if (!file) {
                updateStatus('Please select a file first', 'error');
                return;
            }

            try {
                // Step 1: Check duplicates
                updateStatus('Step 1: Checking for duplicates...', 'info');
                log('Step 1: Checking for duplicates...');
                
                const duplicateResponse = await fetch(`/api/content/check-duplicate?lessonId=${config.lessonId}&title=${encodeURIComponent(config.title)}&type=${config.resourceType}`);
                if (duplicateResponse.ok) {
                    const duplicateResult = await duplicateResponse.json();
                    if (duplicateResult.isDuplicate) {
                        updateStatus('‚ö†Ô∏è Duplicate content detected - upload cancelled', 'warning');
                        log('Duplicate content detected - upload cancelled', 'warning');
                        return;
                    }
                }

                // Step 2: Upload to Cloudinary
                updateStatus('Step 2: Uploading to Cloudinary...', 'info');
                log('Step 2: Uploading to Cloudinary...');

                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', config.uploadPreset);

                let cloudResult;
                try {
                    const cloudResponse = await fetch(`https://api.cloudinary.com/v1_1/${config.cloudName}/auto/upload`, {
                        method: 'POST',
                        body: formData
                    });

                    if (!cloudResponse.ok) throw new Error('Cloudinary upload failed');
                    cloudResult = await cloudResponse.json();
                    
                    updateStatus('Step 2: Cloudinary upload successful', 'success');
                    log(`Step 2: Cloudinary upload successful - ${cloudResult.public_id}`);
                } catch (cloudError) {
                    updateStatus('‚ùå Cloudinary upload failed - stopping upload', 'error');
                    log(`Step 2: Cloudinary upload failed - ${cloudError.message}`, 'error');
                    throw cloudError;
                }

                // Step 3: Save to database
                updateStatus('Step 3: Saving to database...', 'info');
                log('Step 3: Saving to database...');

                const saveResponse = await fetch('/api/content/cloudinary-save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        lessonId: config.lessonId,
                        title: config.title,
                        type: config.resourceType,
                        fileUrl: cloudResult.secure_url,
                        publicId: cloudResult.public_id,
                        size: cloudResult.bytes,
                        mimeType: file.type,
                        resourceType: cloudResult.resource_type
                    })
                });

                if (!saveResponse.ok) {
                    // Cleanup Cloudinary file if database save fails
                    log('Step 3: Database save failed - cleaning up Cloudinary file...');
                    await fetch('/api/cloudinary/cleanup', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            publicId: cloudResult.public_id,
                            resourceType: cloudResult.resource_type
                        })
                    });
                    throw new Error('Database save failed');
                }

                const saveResult = await saveResponse.json();
                
                // Success!
                updateStatus('üéâ Upload completed successfully!', 'success');
                log('Step 3: Database save successful');
                log('üéâ Full upload process completed successfully!');
                
                setResult({
                    cloudinaryResult: cloudResult,
                    databaseResult: saveResult,
                    finalStatus: 'success'
                });

            } catch (error) {
                updateStatus('‚ùå Upload failed', 'error');
                log(`Upload failed: ${error.message}`, 'error');
                
                setResult({
                    error: error.message,
                    finalStatus: 'failed'
                });
            }
        }

        // Error Handling Test
        async function testErrorHandling() {
            log('Testing error handling scenarios...');
            updateStatus('Testing error handling...', 'info');

            const config = getConfig();

            // Test 1: Missing configuration
            log('Test 1: Testing missing configuration...');
            try {
                const response = await fetch('/api/content/cloudinary-save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        lessonId: '', // Missing lessonId
                        title: config.title,
                        type: config.resourceType,
                        fileUrl: 'https://example.com/test.pdf'
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    log(`Missing config error handled: ${errorData.message}`, 'success');
                }
            } catch (error) {
                log(`Missing config test error: ${error.message}`, 'error');
            }

            // Test 2: Invalid file type
            log('Test 2: Testing invalid file type...');
            try {
                const response = await fetch('/api/content/cloudinary-save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        lessonId: config.lessonId,
                        title: config.title,
                        type: 'invalid_type',
                        fileUrl: 'https://example.com/test.pdf'
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    log(`Invalid type error handled: ${errorData.message}`, 'success');
                }
            } catch (error) {
                log(`Invalid type test error: ${error.message}`, 'error');
            }

            updateStatus('‚úÖ Error handling tests completed', 'success');
        }

        // Manual Debug Tests
        function testMissingConfig() {
            log('Testing missing configuration scenario...');
            updateStatus('Testing missing configuration...', 'info');
            
            // Simulate missing Cloudinary config
            const mockConfig = {
                cloudName: '',
                uploadPreset: '',
                lessonId: getConfig().lessonId
            };
            
            if (!mockConfig.cloudName || !mockConfig.uploadPreset) {
                updateStatus('‚úÖ Missing config detected correctly', 'success');
                log('Missing configuration detected correctly', 'success');
            }
        }

        function testInvalidConfig() {
            log('Testing invalid configuration scenario...');
            updateStatus('Testing invalid configuration...', 'info');
            
            // Simulate invalid Cloudinary config
            const mockConfig = {
                cloudName: 'invalid-cloud-name',
                uploadPreset: 'invalid-preset',
                lessonId: 'invalid-lesson-id'
            };
            
            updateStatus('‚ö†Ô∏è Invalid configuration detected', 'warning');
            log('Invalid configuration scenario tested', 'warning');
        }

        function testValidConfig() {
            log('Testing valid configuration scenario...');
            updateStatus('Testing valid configuration...', 'info');
            
            const config = getConfig();
            if (config.cloudName && config.uploadPreset && config.lessonId) {
                updateStatus('‚úÖ Valid configuration confirmed', 'success');
                log('Valid configuration confirmed', 'success');
            }
        }

        function testTimeoutHandling() {
            log('Testing timeout handling...');
            updateStatus('Testing timeout handling...', 'info');
            
            // Simulate timeout by creating a long-running operation
            setTimeout(() => {
                log('Timeout handling test completed', 'success');
                updateStatus('‚úÖ Timeout handling test completed', 'success');
            }, 2000);
        }

        function testLargeFile() {
            log('Testing large file handling...');
            updateStatus('Testing large file handling...', 'info');
            
            // Create a large file blob for testing
            const largeFile = new Blob(['x'.repeat(16 * 1024 * 1024)], { type: 'application/pdf' });
            const file = new File([largeFile], 'large-test.pdf', { type: 'application/pdf' });
            
            log(`Created test file: ${file.name} (${(file.size / (1024 * 1024)).toFixed(2)}MB)`);
            updateStatus('Large file test completed - check validation logic', 'info');
        }

        function testNetworkFailure() {
            log('Testing network failure handling...');
            updateStatus('Testing network failure...', 'warning');
            
            // This would be tested by disconnecting network or using dev tools
            log('Network failure test - manually test by disabling network');
            updateStatus('Network failure test completed - manual verification needed', 'info');
        }

        function testCleanupOnFailure() {
            log('Testing cleanup on failure...');
            updateStatus('Testing cleanup on failure...', 'info');
            
            // Simulate cleanup API call
            fetch('/api/cloudinary/cleanup', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    publicId: 'test_cleanup_id',
                    resourceType: 'image'
                })
            })
            .then(response => {
                if (response.ok) {
                    updateStatus('‚úÖ Cleanup test successful', 'success');
                    log('Cleanup test successful', 'success');
                } else {
                    throw new Error('Cleanup failed');
                }
            })
            .catch(error => {
                updateStatus('‚ùå Cleanup test failed', 'error');
                log(`Cleanup test error: ${error.message}`, 'error');
            });
        }

        function testRetryLogic() {
            log('Testing retry logic...');
            updateStatus('Testing retry logic...', 'info');
            
            // Simulate retry logic with multiple attempts
            let attempts = 0;
            const maxAttempts = 3;
            
            const attemptOperation = () => {
                attempts++;
                log(`Retry attempt ${attempts}/${maxAttempts}`);
                
                if (attempts >= maxAttempts) {
                    updateStatus('‚úÖ Retry logic test completed', 'success');
                    log('Retry logic test completed successfully', 'success');
                } else {
                    setTimeout(attemptOperation, 1000);
                }
            };
            
            attemptOperation();
        }

        function testDuplicatePrevention() {
            log('Testing duplicate prevention...');
            updateStatus('Testing duplicate prevention...', 'info');
            
            // This would test uploading the same file twice
            log('Duplicate prevention test - manually test by uploading same file twice');
            updateStatus('Duplicate prevention test completed - manual verification needed', 'info');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            log('Upload debug test suite loaded', 'success');
            updateStatus('Test suite ready', 'success');
            
            // Auto-run environment config test
            setTimeout(testEnvironmentConfig, 1000);
        });
    </script>
</body>
</html>